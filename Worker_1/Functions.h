+/*
 * Functions.h
 *
 *  Created on: Dec 14, 2015
 *      Author: USER
 */

#ifndef FUNCTIONS_H_
#define FUNCTIONS_H_

#include <stdbool.h>
#include <stdint.h>
#include "inc/hw_i2c.h"
#include "inc/hw_memmap.h"
#include "inc/hw_types.h"
#include "driverlib/rom.h"
#include "driverlib/gpio.h"
#include "driverlib/i2c.h"
#include "driverlib/ssi.h"
#include "driverlib/interrupt.h"
#include "driverlib/pin_map.h"
#include "driverlib/pin_map.h"
#include "driverlib/sysctl.h"
#include "driverlib/uart.h"
#include "utils/uartstdio.h"
#include "inc/hw_nvic.h"
#include "driverlib/systick.h"
#include "driverlib/rom.h"
#include "driverlib/timer.h"
#include "driverlib/udma.h"
#include "driverlib/flash.h"
#include "inc/hw_ssi.h"
#include "driverlib/pwm.h"
#include "driverlib/watchdog.h"
#include "ISR.h"
#include "inc/hw_watchdog.h"
#include "I2C.h"
#include "Functions.h"
#include "HV_Control.h"
#include "inc/tm4c123gh6pge.h"


#if defined(ewarm)
#pragma data_alignment=1024
uint8_t ui8ControlTable[1024];
#elif defined(ccs)
#pragma DATA_ALIGN(ui8ControlTable, 1024)
uint8_t ui8ControlTable[1024];
#else
uint8_t ui8ControlTable[1024] __attribute__ ((aligned(1024)));
#endif

#define BULK_VIN  GPIO_PIN_3
#define DEDX_VIN  GPIO_PIN_2

#define SPI_TXBUF_SIZE 960

#define BULK_RAMP GPIO_PIN_7
#define BULK_PKDT GPIO_PIN_6
#define BULK_A121 GPIO_PIN_5
#define BULK_VIN  GPIO_PIN_3

#define DEDX_RAMP GPIO_PIN_5
#define DEDX_PKDT GPIO_PIN_7
#define DEDX_A121 GPIO_PIN_3
#define DEDX_VIN  GPIO_PIN_2

#define VETO_A121 GPIO_PIN_3


// Address definitions

#define HV_NOR_AD        0xA000
#define HV_HIB_AD        0xA400
#define CT_Time_AD       0xA800
#define Samples_AD       0xB200
#define TSet_AD          0xB600
#define LED_ISet_AD      0xC000
#define SCI_MD_AD        0xC400
#define WT_CT_AD         0xC800
#define SP_MD_ST_AD      0xD200
#define SP_MD_ED_AD      0xD600
#define Fail_Safe_TM     0xE000



uint8_t samples = 2;
uint16_t packet_sequence_count;
uint8_t frame;		//To indicate the number of the fine frame
uint32_t anticoincidence,coincidence;
uint16_t ulADC0_Value,ulADC1_Value;
uint8_t x,y,temp;
uint8_t *trial;
uint16_t *trial2;
uint16_t tracker;	//To track the position of the frame
uint8_t science_data_mode;
uint32_t *fast_counts;
uint8_t transfer;	//To indicate the number of DMA transfers progressed in a packet (There are 7 transfers)
//uint8_t buffer1[60][112];
uint8_t buffer1[60][112] = {{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160}};
uint8_t buffer2[60][112] = {{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,7,161,32,0,1,134,160,0,15,66,64},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,60,0,60,0,60,0,60,0,60,0,60,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,20,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160},{0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,188,2,188,2,188,2,188,2,88,2,88,2,88,2,88,0,100,0,100,0,200,0,200,1,244,1,244,2,88,2,88,2,208,2,208,0,246,0,246,0,10,0,250,0,250,0,250,0,0,0,120,0,0,13,172,0,0,11,184,0,0,15,160}};
//uint8_t buffer2[60][112];
uint8_t trash[60][112] ;
uint16_t *ptr1, *ptr2,*trashman;
uint8_t pyld_status;
uint8_t SPI,IStatus = 0;
uint32_t loop_counter,Buffer1 = 0,FL_TEMP1[4];
uint8_t mode_change;
uint16_t CTime = 0,TSet = 0,LED_ISET = 0,SP_MD_ST = 0 ,SP_MD_ED = 0,pyt = 0;
uint8_t LED_SW = 0, HV_SW = 0 ;


/*---------Watchdog Reload Value----------*/
#define WATCHDOG0_RELOAD 1575000000  //31.5 seconds @ 50 MHz


/*----------Lookup table base-----------*/
#define LOOKUP_BASE			0x19000               //Corresponds to 100 KB size from 0x000 for code
#define LOOKUP2_BASE 		0x1D000				  //Corresponds to the anticoincidence lookup table

//Ping pong buffers for data storage--Transfer occurs for every KB of data generated

uint16_t high_voltage,low_voltage;

#define SLAVE_ADDRESS           0x20

void HK_Begin(void);
void DMA_SPI_Transfer_Science(int SPI1);
void PL_PREV_STATE_CHECK(uint8_t );
void BLUELED_Blink(void);
void REDLED_Blink(void);


void Fail_Safe_Timer(void)
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER1);
    TimerConfigure(TIMER1_BASE, TIMER_CFG_PERIODIC);
    TimerLoadSet(TIMER1_BASE, TIMER_B, SysCtlClockGet()*30);
    IntEnable(INT_TIMER2B);
    TimerEnable(TIMER1_BASE, TIMER_B);
    TimerIntEnable(TIMER1_BASE, TIMER_TIMB_TIMEOUT);
}

void Boot_Up (void)
{
	UARTprintf("Initializing Variables \n");
	Buffer1       = HWREG(HV_NOR_AD);
	high_voltage = Buffer1;
	UARTprintf("High Voltage set at %d \n",high_voltage);
	Buffer1      = HWREG(HV_HIB_AD);
	low_voltage  = Buffer1;
	UARTprintf("Hibernate Voltage set at %d \n",low_voltage);
	Buffer1       = HWREG(CT_Time_AD);
	CTime        = Buffer1;
	UARTprintf("Coincidence Time is set as %d \n" , CTime);
	Buffer1      = HWREG(Samples_AD);
	samples      = Buffer1;
	UARTprintf("Samples Set at %d \n", samples);
	Buffer1      = HWREG(TSet_AD);
	TSet         = Buffer1;
	UARTprintf("Threshold Set at %d \n", TSet);
	Buffer1      = HWREG(LED_ISet_AD);
	LED_ISET     = Buffer1;
	UARTprintf("LED Threshold Set at %d \n", LED_ISET);
	Buffer1      = HWREG(SCI_MD_AD);
	science_data_mode     = Buffer1;
	UARTprintf("Science Data Mode %d \n", science_data_mode);
	Buffer1       = HWREG(SP_MD_ST_AD);
	SP_MD_ST     = Buffer1;
	UARTprintf("Scatter Plot Start at %d \n", SP_MD_ST);
	Buffer1       = HWREG(SP_MD_ED_AD);
	SP_MD_ED     = Buffer1;
	UARTprintf("Scatter Plot End at %d \n", SP_MD_ED);
}

void Flash_Parameter_Program(void)
{
	FL_TEMP1[0]   = 0;
	FlashErase(HV_NOR_AD);
	FlashProgram(FL_TEMP1, HV_NOR_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 0;
	FlashErase(HV_HIB_AD);
	FlashProgram(FL_TEMP1, HV_HIB_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 1000;
	FlashErase(CT_Time_AD);
	FlashProgram(FL_TEMP1, CT_Time_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 890;
	FlashErase(TSet_AD);
	FlashProgram(FL_TEMP1, TSet_AD , 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 890;
	FlashErase(LED_ISet_AD);
	FlashProgram(FL_TEMP1, LED_ISet_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 2;
	FlashErase(Samples_AD);
	FlashProgram(FL_TEMP1, Samples_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 0;
	FlashErase(SCI_MD_AD);
	FlashProgram(FL_TEMP1, SCI_MD_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 100;
	FlashErase(SP_MD_ST_AD);
	FlashProgram(FL_TEMP1, SP_MD_ST_AD, 4);
	SysCtlDelay(100000);
	FL_TEMP1[0]   = 145;
	UARTprintf("Flash Write Status %d \n",FlashErase(SP_MD_ED_AD));
	FlashProgram(FL_TEMP1, SP_MD_ED_AD, 4);
	SysCtlDelay(100000);

}

void Lookup_Create(void)
{
	int i,j,k;
	k=0;
	uint32_t addr=LOOKUP_BASE;
	int counter=0;
	//Erasing the flash
	for(i=0;i<128;i++)
	{
		for(j=0;j<128;j++)
		{
			addr++;
			counter++;
			if(counter==1000)
				{
					FlashErase(addr);
					counter=0;
				}
		}
	}
	for(i=0;i<128;i++)
	{
		for(j=0;j<128;j++)
		{
			addr++;
			counter++;
			if(counter==1000)
				{
					FlashErase(addr);
					counter=0;
				}
		}
	}

	//Programming the Flash
	addr=LOOKUP_BASE;
	uint8_t a[4];		//Programming the coincidence lookup table
	for(i=0;i<128;i++)
	{
		for(j=0;j<128;j++)
		{
			a[k]=i/3;
			k++;
			addr++;
			if(k==4)
			{
				k=0;
				FlashProgram((uint32_t *)a,addr,4);
			}
		}
	}
	for(i=0;i<128;i++)		//Programming the anticoincidence lookup table
	{
		for(j=0;j<128;j++)
		{
			a[k]=i%4+44;
			k++;
			addr++;
			if(k==4)
			{
				k=0;
				FlashProgram((uint32_t *)a,addr,4);
			}
		}
	}
}



void HK_Timer_Config(void) // 20 Sec // need to set priority
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER2);
    TimerConfigure(TIMER2_BASE, TIMER_CFG_PERIODIC);
    TimerLoadSet(TIMER2_BASE, TIMER_A, SysCtlClockGet()*20);
    IntEnable(INT_TIMER2A);
    TimerEnable(TIMER2_BASE, TIMER_A);
    TimerIntEnable(TIMER2_BASE, TIMER_TIMA_TIMEOUT);
}

void InitDMA(int SPI)
{
	if (SPI == 0)
	{
		SysCtlPeripheralEnable(SYSCTL_PERIPH_UDMA);
		IntEnable(INT_UDMAERR);
		uDMAEnable();
		uDMAControlBaseSet(ui8ControlTable);
		uDMAChannelAssign( UDMA_CH11_SSI0TX );
		uDMAChannelAttributeDisable(UDMA_CHANNEL_SSI0TX,UDMA_ATTR_ALL);
		uDMAChannelAttributeEnable(UDMA_CHANNEL_SSI0TX, UDMA_ATTR_USEBURST);
		uDMAChannelControlSet(UDMA_CHANNEL_SSI0TX,UDMA_SIZE_8| UDMA_SRC_INC_8 | UDMA_DST_INC_NONE |
									  UDMA_ARB_1);
		SSIDMAEnable(SSI0_BASE,SSI_DMA_TX);
		uDMAChannelDisable(UDMA_CHANNEL_SSI0TX);
	}
	else if (SPI == 1)
	{
		SysCtlPeripheralEnable(SYSCTL_PERIPH_UDMA);
		IntEnable(INT_UDMAERR);
		uDMAEnable();
		uDMAControlBaseSet(ui8ControlTable);
		uDMAChannelAssign( UDMA_CH15_SSI3TX );
		uDMAChannelAttributeDisable(UDMA_CHANNEL_ADC1,UDMA_ATTR_ALL);
		uDMAChannelAttributeEnable(UDMA_CHANNEL_ADC1, UDMA_ATTR_USEBURST);
		uDMAChannelControlSet(UDMA_CHANNEL_ADC1,UDMA_SIZE_16| UDMA_SRC_INC_16 | UDMA_DST_INC_NONE |
									  UDMA_ARB_1);
		SSIDMAEnable(SSI3_BASE,SSI_DMA_TX);
		uDMAChannelDisable(UDMA_CHANNEL_ADC1);

	}
}

void DMA_SPI_Transfer_Science(int SPI1)
{
	if (SPI1 == 0)
	{
		IntEnable(INT_SSI0); // Interrupt generated by DMA transfer complete
		while(uDMAChannelIsEnabled(UDMA_CHANNEL_SSI0TX)); // wait till the previous transfer is done

		uDMAChannelTransferSet(UDMA_CHANNEL_SSI0TX | UDMA_PRI_SELECT,
									  UDMA_MODE_BASIC, ptr2+transfer*480,
									  (void *)(SSI0_BASE + SSI_O_DR),
									  SPI_TXBUF_SIZE);
		transfer++;
		uDMAChannelEnable(UDMA_CHANNEL_SSI0TX);
	}

	else if (SPI1 == 1)
	{
		IntEnable(INT_SSI3); // Interrupt generated by DMA transfer complete
		while(uDMAChannelIsEnabled(UDMA_CHANNEL_ADC1)); // wait till the previous transfer is done

		uDMAChannelTransferSet(UDMA_CHANNEL_ADC1 | UDMA_PRI_SELECT,
									  UDMA_MODE_BASIC, ptr2,
									  (void *)(SSI3_BASE + SSI_O_DR),
									  SPI_TXBUF_SIZE);
		uDMAChannelEnable(UDMA_CHANNEL_ADC1);
	}
	//UARTprintf("DMA Configured \n" );

}

void Configure_SSI_Science(void)
{
	if(SPI==0)
	    {
			SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI0);
			SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);
			GPIOPinConfigure(GPIO_PA2_SSI0CLK);
			GPIOPinConfigure(GPIO_PA3_SSI0FSS);
			GPIOPinConfigure(GPIO_PA4_SSI0RX);
			GPIOPinConfigure(GPIO_PA5_SSI0TX);
			GPIOPinTypeSSI(GPIO_PORTA_BASE,GPIO_PIN_2|GPIO_PIN_3|GPIO_PIN_4|GPIO_PIN_5);
	    	SSIConfigSetExpClk(SSI0_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0, SSI_MODE_MASTER, 1000000, 8);
	    	SSIEnable(SSI0_BASE);
	    	/*SysCtlDelay(100);
	    	SSIDataPut(SSI0_BASE,0);
	    	while(SSIBusy(SSI0_BASE));
	    	SSIDataPut(SSI0_BASE,0);
	    	while(SSIBusy(SSI0_BASE));
	    	SSIDataPut(SSI0_BASE,0);
	    	while(SSIBusy(SSI0_BASE));
	    	SSIDataPut(SSI0_BASE,0);
	    	while(SSIBusy(SSI0_BASE));*/

	    }
	    else if(SPI==1)
	    {
		    SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI3);
		    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
		    GPIOPinConfigure(GPIO_PH0_SSI3CLK);
		    GPIOPinConfigure(GPIO_PH1_SSI3FSS);
		    GPIOPinConfigure(GPIO_PH2_SSI3RX);
		    GPIOPinConfigure(GPIO_PH3_SSI3TX);
		    GPIOPinTypeSSI(GPIO_PORTH_BASE, GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_2 |
		                   GPIO_PIN_3);
		    SSIConfigSetExpClk(SSI3_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0,
		                       SSI_MODE_MASTER, 1000000, 16);
		    SSIEnable(SSI3_BASE);
	    }
}



void Configure_DAC(void)
{
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI1);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPION);
	    GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE, GPIO_PIN_7);
	    GPIOPinConfigure(GPIO_PF2_SSI1CLK);
	    GPIOPinConfigure(GPIO_PF3_SSI1FSS);
	    GPIOPinConfigure(GPIO_PF0_SSI1RX);
	    GPIOPinConfigure(GPIO_PF1_SSI1TX);
	    GPIOPinTypeSSI(GPIO_PORTF_BASE, GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_2 |
	                   GPIO_PIN_3);
	    SSIConfigSetExpClk(SSI1_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0,
	                       SSI_MODE_MASTER, 1000000, 8);
	    SSIEnable(SSI1_BASE);
}

void Configure_LED_Driver(void)
{
		uint32_t Rx[2];
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI3);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOK);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPION);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
	    GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE, GPIO_PIN_2);
	    GPIOPinTypeGPIOInput(GPIO_PORTH_BASE,  GPIO_PIN_2);
	    GPIOPinConfigure(GPIO_PK0_SSI3CLK);
	    GPIOPinConfigure(GPIO_PK1_SSI3FSS);
	    GPIOPinConfigure(GPIO_PK2_SSI3RX);
	    GPIOPinConfigure(GPIO_PK3_SSI3TX);
	    GPIOPinTypeSSI(GPIO_PORTK_BASE, GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_2 |
	                   GPIO_PIN_3);
	    SSIConfigSetExpClk(SSI3_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0,
	                       SSI_MODE_MASTER, 5000000, 8);
	    SSIEnable(SSI3_BASE);

	    GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_2,0);
	    SysCtlDelay(100);
	    SSIDataPut(SSI3_BASE,255);
	    while(SSIBusy(SSI3_BASE));
	    GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_2,GPIO_PIN_2);
	    SysCtlDelay(1000000);
	    GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_2,0);
	    SSIDataGet(SSI3_BASE,&Rx[0]);
	    UARTprintf("Data : %d \n",Rx[0]);


	    //Setting up the PWM module
	    SysCtlPWMClockSet(SYSCTL_PWMDIV_1);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_PWM0);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
	    GPIOPinConfigure(GPIO_PH6_M0PWM6);
	    //GPIOPinConfigure(GPIO_PB7_M0PWM7);
	    GPIOPinTypePWM(GPIO_PORTH_BASE, GPIO_PIN_6);
	    //GPIOPinTypePWM(GPIO_PORTB_BASE, GPIO_PIN_7);
	    PWMGenConfigure(PWM0_BASE, PWM_GEN_3, PWM_GEN_MODE_UP_DOWN |
	                    PWM_GEN_MODE_NO_SYNC);
	    PWMGenPeriodSet(PWM0_BASE, PWM_GEN_3, 200000);
	    SysCtlDelay(10);
	    PWM0_INVERT_R|=0xFFFFF;
	    SysCtlDelay(10);
	    PWM0_3_CMPA_R=475;
	    SysCtlDelay(10);
	    PWM0_3_CMPB_R=500;			//(CMPB_R-CMPA_R)*12.5=Size of the pulse in PB6/PB7 (in nanoseconds).
	    SysCtlDelay(10);
	    PWM0_3_GENA_R=0b000100010000;
	    SysCtlDelay(10);
	    PWM0_3_GENB_R=0b000100010000;
	    PWMOutputState(PWM0_BASE, PWM_OUT_6_BIT | PWM_OUT_0_BIT, true);
	    PWMGenEnable(PWM0_BASE, PWM_GEN_3);

}

void Configure_Science_Timer(void)
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER0);		//The 0.1 second timer for science data; The 6 sec is also done by this
    TimerConfigure(TIMER0_BASE, TIMER_CFG_PERIODIC);	//timer in order to avoid any issues with synchronizing
    TimerLoadSet(TIMER0_BASE, TIMER_A, SysCtlClockGet()*0.1);
    IntEnable(INT_TIMER0A);
    TimerEnable(TIMER0_BASE, TIMER_A);
    TimerIntEnable(TIMER0_BASE, TIMER_TIMA_TIMEOUT);
}

void Configure_HV_Timer(void)
{

	//Enabling the timer
	SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER1);
	TimerConfigure(TIMER1_BASE,TIMER_CFG_PERIODIC);
	TimerLoadSet(TIMER1_BASE,TIMER_A,SysCtlClockGet()*20);
	IntEnable(INT_TIMER1A);
	TimerEnable(TIMER1_BASE,TIMER_A);
	TimerIntEnable(TIMER1_BASE,TIMER_TIMA_TIMEOUT);
}

void BLUELED_Blink(void)
{
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_0 , GPIO_PIN_0 );
	SysCtlDelay(100000);
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_0 , 0 );

}

void REDLED_Blink(void)
{
	GPIOPinWrite(GPIO_PORTH_BASE, GPIO_PIN_0 , GPIO_PIN_0 );
	SysCtlDelay(100000);
	GPIOPinWrite(GPIO_PORTH_BASE, GPIO_PIN_0 , 0 );
}

void GPIOConfigure(void)
{

	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOC);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPION);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOL);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOK);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOD);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOC);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOB);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOM);
	GPIOPinTypeGPIOOutput(GPIO_PORTF_BASE, GPIO_PIN_1|GPIO_PIN_2|GPIO_PIN_3|GPIO_PIN_5|GPIO_PIN_6);
	GPIOPinTypeGPIOOutput(GPIO_PORTC_BASE,GPIO_PIN_7);
	GPIOPinTypeGPIOOutput(GPIO_PORTH_BASE,GPIO_PIN_5);
	GPIOPinWrite(GPIO_PORTH_BASE, GPIO_PIN_5, GPIO_PIN_5);
	GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE,GPIO_PIN_1);
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_1, GPIO_PIN_1);
	GPIOPinTypeGPIOInput(GPIO_PORTF_BASE, GPIO_PIN_5);
	GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE, GPIO_PIN_0|GPIO_PIN_7|GPIO_PIN_1);
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_7, GPIO_PIN_7);
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_1, GPIO_PIN_1); // Switching off HV side
	GPIOPinTypeGPIOOutput(GPIO_PORTH_BASE, GPIO_PIN_0);
	GPIOPinTypeGPIOOutput(GPIO_PORTA_BASE, GPIO_PIN_0|GPIO_PIN_1);
	GPIOPinWrite(GPIO_PORTA_BASE, GPIO_PIN_0|GPIO_PIN_1, 0);
	GPIOPinTypeGPIOOutput(GPIO_PORTK_BASE, GPIO_PIN_5);
	GPIOPinWrite(GPIO_PORTK_BASE, GPIO_PIN_5, GPIO_PIN_5);
	GPIOPinTypeGPIOOutput(GPIO_PORTK_BASE, GPIO_PIN_7);
	GPIOPinWrite(GPIO_PORTK_BASE, GPIO_PIN_7, GPIO_PIN_7);
	GPIOPinTypeGPIOOutput(GPIO_PORTD_BASE, GPIO_PIN_7);
	GPIOPinTypeGPIOOutput(GPIO_PORTL_BASE, GPIO_PIN_6);
	GPIOPinWrite(GPIO_PORTD_BASE, GPIO_PIN_7, GPIO_PIN_7);
	GPIOPinTypeGPIOInput(GPIO_PORTD_BASE, GPIO_PIN_4|GPIO_PIN_6);
	GPIOPinTypeGPIOInput(GPIO_PORTL_BASE, GPIO_PIN_2|GPIO_PIN_7);

	GPIOPinTypeGPIOOutput(GPIO_PORTD_BASE, GPIO_PIN_5);
	GPIOPinTypeGPIOOutput(GPIO_PORTL_BASE, GPIO_PIN_3);
	GPIOPinTypeGPIOOutput(GPIO_PORTC_BASE, GPIO_PIN_4);
	GPIOPinTypeGPIOInput(GPIO_PORTC_BASE, GPIO_PIN_5);
	GPIOIntTypeSet(GPIO_PORTD_BASE, GPIO_PIN_4 , GPIO_RISING_EDGE);
	GPIOIntTypeSet(GPIO_PORTL_BASE, GPIO_PIN_2 , GPIO_RISING_EDGE);
	GPIOIntEnable(GPIO_PORTD_BASE, GPIO_INT_PIN_4);
	GPIOIntEnable(GPIO_PORTL_BASE, GPIO_INT_PIN_2);
	SysCtlDelay(10);
	GPIOPinTypeGPIOInput(GPIO_PORTB_BASE,VETO_A121);
	GPIOIntTypeSet(GPIO_PORTB_BASE,VETO_A121,GPIO_RISING_EDGE);
	GPIOIntEnable(GPIO_PORTB_BASE,VETO_A121);
	GPIOPinTypeGPIOInput(GPIO_PORTM_BASE,GPIO_PIN_1); // OVC HV
	GPIOIntTypeSet(GPIO_PORTM_BASE, GPIO_PIN_1 , GPIO_RISING_EDGE);
	GPIOIntEnable(GPIO_PORTM_BASE, GPIO_INT_PIN_1);
	IntEnable(INT_GPIOM);

}



void ConfigureI2CSlave(void)
{
	IStatus = 1;
	SysCtlPeripheralEnable(SYSCTL_PERIPH_I2C1);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);
	SysCtlPeripheralReset(SYSCTL_PERIPH_I2C1);
	//GPIOPinTypeGPIOOutput(GPIO_PORTB_BASE, GPIO_PIN_0|GPIO_PIN_1);
	GPIOPinConfigure(GPIO_PA6_I2C1SCL);
	GPIOPinConfigure(GPIO_PA7_I2C1SDA);
	GPIOPadConfigSet(GPIO_PORTA_BASE,GPIO_PIN_7,GPIO_STRENGTH_2MA,GPIO_PIN_TYPE_OD);   // set the pin as open drain


	GPIOPinTypeI2CSCL(GPIO_PORTA_BASE, GPIO_PIN_6);
    GPIOPinTypeI2C(GPIO_PORTA_BASE, GPIO_PIN_7);

    I2CSlaveIntEnableEx(I2C1_BASE, I2C_SLAVE_INT_DATA); // Slave Interrupt configure
    IntMasterEnable();
    IntEnable(INT_I2C1);
    I2CSlaveEnable(I2C1_BASE);
    I2CSlaveInit(I2C1_BASE, SLAVE_ADDRESS); // Slave configure
	UARTprintf("I2C configured\n");

}

void Fast_Init(void)
{
	//Bulk A121 counter
	SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER4);
	TimerConfigure(WTIMER4_BASE,(TIMER_CFG_SPLIT_PAIR|TIMER_CFG_A_CAP_COUNT_UP));
	TimerControlEvent(WTIMER4_BASE,TIMER_A,TIMER_EVENT_POS_EDGE);

	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOD);
	GPIOPinTypeTimer(GPIO_PORTD_BASE,GPIO_PIN_4);
	GPIOPinConfigure(GPIO_PD4_WT4CCP0);


	//dEdX A121 counter
	SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER1);
	TimerConfigure(WTIMER1_BASE,(TIMER_CFG_SPLIT_PAIR|TIMER_CFG_A_CAP_COUNT_UP));
	TimerControlEvent(WTIMER1_BASE,TIMER_A,TIMER_EVENT_POS_EDGE);

	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOL);
	GPIOPinTypeTimer(GPIO_PORTL_BASE,GPIO_PIN_2);
	GPIOPinConfigure(GPIO_PL2_WT1CCP0);

	//Veto A121 counter
	SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER3);
	TimerConfigure(WTIMER3_BASE,(TIMER_CFG_SPLIT_PAIR|TIMER_CFG_A_CAP_COUNT_UP));
	TimerControlEvent(WTIMER3_BASE,TIMER_A,TIMER_EVENT_POS_EDGE);


	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOD);
	GPIOPinTypeTimer(GPIO_PORTD_BASE,GPIO_PIN_2);
	GPIOPinConfigure(GPIO_PD2_WT3CCP0);

	//Enabling all the timers
	TimerEnable(WTIMER3_BASE,TIMER_A);
	TimerEnable(WTIMER1_BASE,TIMER_A);
	TimerEnable(WTIMER4_BASE,TIMER_A);

	WTIMER1_TAV_R=0;	//Resetting the timers
	WTIMER1_TAPS_R=0;

	WTIMER4_TAV_R=0;
	WTIMER4_TAPS_R=0;

	WTIMER3_TAV_R=0;
	WTIMER3_TAPS_R=0;

}
void ConfigureUART(void)
{
    //
    // Enable GPIO port A which is used for UART0 pins.

    // Enable the GPIO Peripheral used by the UART.
    //
    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOG);

    //
    // Enable UART0
    //
    SysCtlPeripheralEnable(SYSCTL_PERIPH_UART2);

    //
    // Configure GPIO Pins for UART mode.
    //
    GPIOPinConfigure(GPIO_PG4_U2RX);
    GPIOPinConfigure(GPIO_PG5_U2TX);
    GPIOPinTypeUART(GPIO_PORTG_BASE, GPIO_PIN_4 | GPIO_PIN_5);

    //
    // Use the internal 16MHz oscillator as the UART clock source.
    //
    UARTClockSourceSet(UART2_BASE, UART_CLOCK_PIOSC);

    //
    // Initialize the UART for console I/O.
    //
    UARTStdioConfig(2, 115200, 16000000);


}

void Clean_Buffer(void)
{
	int i,j;
	frame=0;
	for(i=0;i<60;i++)
	{
		for(j=0;j<112;j++)
		{
			buffer1[i][j]=0;
			buffer2[i][j]=0;
		}
	}
}

void Print_Buffer (void)
{
	int i,j;
	frame=0;
	for(i=0;i<60;i++)
	{
		for(j=0;j<112;j++)
		{
			UARTprintf("%d,",buffer2[i][j]);

			//UARTprintf("%d,", &ptr2[i][j]);
		}
		UARTprintf("\n");
		//ptr2++;
	}
}

void
ConfigureWatchdog(void)
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_WDOG0);
    WatchdogUnlock(WATCHDOG0_BASE);
    WatchdogReloadSet(WATCHDOG0_BASE,WATCHDOG0_RELOAD);
    WATCHDOG0_TEST_R=256;				//Enabling Watchdog Halting during debugging
    WatchdogResetEnable(WATCHDOG0_BASE);
    IntEnable(INT_WATCHDOG);
    WatchdogEnable(WATCHDOG0_BASE);
    WatchdogLock(WATCHDOG0_BASE);
}

void
Configure_ADC(void)
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_ADC0);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_ADC1);
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOE);
	GPIOPinTypeADC(GPIO_PORTE_BASE, BULK_VIN|DEDX_VIN);
	ADCSequenceConfigure(ADC0_BASE, 3, ADC_TRIGGER_PROCESSOR, 0);
	ADCSequenceStepConfigure(ADC0_BASE, 3, 0, ADC_CTL_CH1 | ADC_CTL_IE | ADC_CTL_END);
	ADCSequenceEnable(ADC0_BASE, 3);
	ADCSequenceConfigure(ADC1_BASE, 3, ADC_TRIGGER_PROCESSOR, 0);
	ADCSequenceStepConfigure(ADC1_BASE, 3, 0, ADC_CTL_CH0 | ADC_CTL_IE | ADC_CTL_END);
	ADCSequenceEnable(ADC1_BASE, 3);

	ADCIntClear(ADC0_BASE, 3);
	ADCIntClear(ADC1_BASE,3);
}

void Configure_Analog(void)
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPION);		//Function for switching on the power supply to the Analog Chain
	GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE,GPIO_PIN_4|GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_4,0);	//Switching on the D, and then the Clock for the latch
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);			//Giving a 'clock' pulse
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	UARTprintf("Analog part of Payload is ON \n");
}

void Disable_Analog(void)		//Function for switching off the analog chain
{
	SysCtlPeripheralEnable(SYSCTL_PERIPH_GPION);		//Function for switching on the power supply to the Analog Chain
	GPIOPinTypeGPIOOutput(GPIO_PORTN_BASE,GPIO_PIN_4|GPIO_PIN_5);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_4,0);		//Setting the data to zero
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,GPIO_PIN_5);
	SysCtlDelay(100);
	GPIOPinWrite(GPIO_PORTN_BASE,GPIO_PIN_5,0);
	UARTprintf("Analog part of Payload is OFF \n");
}


void PYLD_SPEED_INIT(void)
{

}

void PYLD_SPEED_STANDBY_INIT(void)
{
	  SysCtlClockSet(SYSCTL_SYSDIV_2_5 | SYSCTL_USE_PLL | SYSCTL_XTAL_16MHZ |
	                       SYSCTL_OSC_MAIN);
	    //To insert corrective action here
	    PL_PREV_STATE_CHECK(1);
	    pyld_status=1;
	    GPIOConfigure();
		ConfigureUART();
		Boot_Up();
	    if (IStatus ==  0)
	    {
		ConfigureI2CSlave();
	    }
	    else
	    {
	    UARTprintf("I2C Skipped \n");
	    }
		SPI=0;
		high_voltage=0;
		low_voltage=0;
		ptr1=(uint16_t *)buffer1;
		ptr2=(uint16_t *)buffer2;
		GPIO_PORTD_LOCK_R=0x4C4F434B;		//Unlocking the NMI pin PD7
	    SysTickPeriodSet(10000);
		GPIO_PORTD_CR_R|=GPIO_PIN_7;		//Unlocking the NMI pin PD7
		packet_sequence_count=0;
		Configure_SSI_Science();
		HK_Timer_Config();
		HK_Begin();
		UARTprintf("Payload PCB is in Standby ...  \n");
}

void Configure_ADC_HV(void)
{
    SysCtlPeripheralEnable(SYSCTL_PERIPH_ADC0);
    SysCtlDelay(10);
    ADCSequenceConfigure(ADC0_BASE, 3, ADC_TRIGGER_PROCESSOR, 0);
    ADCSequenceStepConfigure(ADC0_BASE, 3, 0, ADC_CTL_CH9 | ADC_CTL_IE |
                                 ADC_CTL_END);
    ADCSequenceEnable(ADC0_BASE, 3);
    ADCHardwareOversampleConfigure(ADC0_BASE,64);
    ADCIntClear(ADC0_BASE, 3);
}


void Configure_ADC_SCI(void)
{

    SysCtlPeripheralEnable(SYSCTL_PERIPH_ADC1);
    SysCtlDelay(10);
    ADCSequenceConfigure(ADC1_BASE, 3, ADC_TRIGGER_PROCESSOR, 0);

    ADCSequenceStepConfigure(ADC1_BASE, 3, 0, ADC_CTL_CH0 | ADC_CTL_IE |
                                 ADC_CTL_END);
    ADCSequenceEnable(ADC1_BASE, 3);
    ADCIntClear(ADC1_BASE, 3);
    ADCHardwareOversampleConfigure(ADC1_BASE,samples);
    SysCtlPeripheralEnable(SYSCTL_PERIPH_ADC0);
    SysCtlDelay(10);
    ADCSequenceConfigure(ADC0_BASE, 3, ADC_TRIGGER_PROCESSOR, 0);

    ADCSequenceStepConfigure(ADC0_BASE, 3, 0, ADC_CTL_CH1 | ADC_CTL_IE |
                                 ADC_CTL_END);
    ADCSequenceEnable(ADC0_BASE, 3);
    ADCHardwareOversampleConfigure(ADC0_BASE,samples);
    ADCIntClear(ADC0_BASE, 3);
}

void Configure_DPOT(void)
{
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI3);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOK);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOL);
	    GPIOPinTypeGPIOOutput(GPIO_PORTL_BASE, GPIO_PIN_6);
	    GPIOPinWrite(GPIO_PORTL_BASE, GPIO_PIN_6, GPIO_PIN_6);
	    GPIOPinConfigure(GPIO_PK0_SSI3CLK);
	    GPIOPinConfigure(GPIO_PK1_SSI3FSS);
	    GPIOPinConfigure(GPIO_PK2_SSI3RX);
	    GPIOPinConfigure(GPIO_PK3_SSI3TX);
	    GPIOPinTypeSSI(GPIO_PORTK_BASE, GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_2 |
	                   GPIO_PIN_3);
	    SSIConfigSetExpClk(SSI3_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0,
	                       SSI_MODE_MASTER, 100000, 16);
	    SSIEnable(SSI3_BASE);
	    GPIOPinWrite(GPIO_PORTL_BASE, GPIO_PIN_6, 0);
	    SSIDataPut(SSI3_BASE,TSet);
	    while(SSIBusy(SSI3_BASE));
	    GPIOPinWrite(GPIO_PORTL_BASE, GPIO_PIN_6, GPIO_PIN_6);
}

void Configure_DPOT_LED(void)
{
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_SSI3);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOK);
	    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOH);
	    GPIOPinTypeGPIOOutput(GPIO_PORTL_BASE, GPIO_PIN_6);
	    GPIOPinWrite(GPIO_PORTL_BASE, GPIO_PIN_6, GPIO_PIN_6);
	    GPIOPinConfigure(GPIO_PK0_SSI3CLK);
	    GPIOPinConfigure(GPIO_PK1_SSI3FSS);
	    GPIOPinConfigure(GPIO_PK2_SSI3RX);
	    GPIOPinConfigure(GPIO_PK3_SSI3TX);
	    GPIOPinTypeSSI(GPIO_PORTK_BASE, GPIO_PIN_0 | GPIO_PIN_1 | GPIO_PIN_2 |
	                   GPIO_PIN_3);
	    SSIConfigSetExpClk(SSI3_BASE, SysCtlClockGet(), SSI_FRF_MOTO_MODE_0,
	                       SSI_MODE_MASTER, 100000, 16);
	    SSIEnable(SSI3_BASE);
	    GPIOPinWrite(GPIO_PORTH_BASE, GPIO_PIN_4, 0);
	    SSIDataPut(SSI3_BASE,LED_ISET);
	    while(SSIBusy(SSI3_BASE));
	    GPIOPinWrite(GPIO_PORTH_BASE, GPIO_PIN_4, GPIO_PIN_4);
}

void PYLD_SPEED_HIBERNATE_INIT(void)
{
    SysCtlClockSet(SYSCTL_SYSDIV_2_5 | SYSCTL_USE_PLL | SYSCTL_XTAL_16MHZ |
                       SYSCTL_OSC_MAIN);
    //To insert corrective action here

    PL_PREV_STATE_CHECK(2);
    pyld_status=2;
	ptr1=(uint16_t *)buffer1;
	ptr2=(uint16_t *)buffer2;
	GPIO_PORTD_LOCK_R=0x4C4F434B;		//Unlocking the NMI pin PD7
    SysTickPeriodSet(10000);
	GPIO_PORTD_CR_R|=GPIO_PIN_7;		//Unlocking the NMI pin PD7
	packet_sequence_count=0;
	Configure_Analog();
	Configure_DAC();
	DAC_Config();
	//HV_Value_Set(low_voltage);
	//Configure_HV_Timer();
	Configure_SSI_Science();
	InitDMA(0);
	UARTprintf("in hibernate \n");

}

void PYLD_SPEED_SCIENCE_INIT(void)
{
    SysCtlClockSet(SYSCTL_SYSDIV_2_5 | SYSCTL_USE_PLL | SYSCTL_XTAL_16MHZ |
                       SYSCTL_OSC_MAIN);
    pyld_status=3;
	GPIO_PORTD_LOCK_R=0x4C4F434B;		//Unlocking the NMI pin PD7
    SysTickPeriodSet(10000);
	GPIO_PORTD_CR_R|=GPIO_PIN_7;		//Unlocking the NMI pin PD7
	ptr1=(uint16_t *)buffer1;
	ptr2=(uint16_t *)buffer2;
	packet_sequence_count=0;
	Configure_Analog();
	Configure_DAC();
	DAC_Config();
	GPIOPinWrite(GPIO_PORTN_BASE, GPIO_PIN_1, GPIO_PIN_1);
	//HV_Value_Set(high_voltage);
	//HV_CONTROL();
	Fast_Init();
	//Configure_HV_Timer();
	Configure_SSI_Science();
	InitDMA(0);
	Configure_Science_Timer();
	GPIOPinWrite(GPIO_PORTD_BASE,BULK_RAMP,0);
	GPIOPinWrite(GPIO_PORTK_BASE,DEDX_RAMP,0);
	SysCtlDelay(10000);
	BLUELED_Blink();
	GPIOPinWrite(GPIO_PORTD_BASE, BULK_RAMP, BULK_RAMP);
	GPIOPinWrite(GPIO_PORTK_BASE, DEDX_RAMP, DEDX_RAMP);
	UARTprintf("PYLD In Science State \n");
}

void PL_SCIENCE_INT_DISABLE(void)
{
	//Clearing and disabling dEdx interrupts
	GPIO_PORTL_ICR_R|=DEDX_A121;
	GPIOIntDisable(GPIO_PORTL_BASE,DEDX_A121);
	IntDisable(INT_GPIOL);

	//Clearing and disabling Bulk interrupts
	GPIO_PORTD_ICR_R|=BULK_A121;
	GPIOIntDisable(GPIO_PORTD_BASE,BULK_A121);
	IntDisable(INT_GPIOD);

	//Clearing and disabling Veto interrupts
    GPIO_PORTB_ICR_R|=VETO_A121;
    GPIOIntDisable(GPIO_PORTB_BASE,VETO_A121);
    IntDisable(INT_GPIOB);

    //Clearing and disabling the science timer interrupt
	TimerIntClear(TIMER0_BASE,TIMER_TIMA_TIMEOUT);
	IntPendClear(INT_TIMER0A);
    TimerIntDisable(TIMER0_BASE, TIMER_TIMA_TIMEOUT);
    IntPendClear(INT_TIMER0A);
    IntDisable(INT_TIMER0A);

    UARTprintf("GPIO cleared \n");

    //Clearing and disabling the fast timers
	WTIMER1_TAV_R=0;	//Resetting the timers
	WTIMER1_TAPS_R=0;

	WTIMER4_TAV_R=0;
	WTIMER4_TAPS_R=0;

	WTIMER3_TAV_R=0;
	WTIMER3_TAPS_R=0;
    TimerDisable(WTIMER3_BASE,TIMER_A);
    TimerDisable(WTIMER1_BASE,TIMER_A);
    TimerDisable(WTIMER4_BASE,TIMER_A);

}

void PL_GPIO_INT_Disable(void)
{
	GPIO_PORTL_ICR_R|=DEDX_A121;
	GPIOIntDisable(GPIO_PORTL_BASE,DEDX_A121);
	IntDisable(INT_GPIOL);

	//Clearing and disabling Bulk interrupts
	GPIO_PORTD_ICR_R|=BULK_A121;
	GPIOIntDisable(GPIO_PORTD_BASE,BULK_A121);
	IntDisable(INT_GPIOD);

	//Clearing and disabling Veto interrupts
    GPIO_PORTB_ICR_R|=VETO_A121;
    GPIOIntDisable(GPIO_PORTB_BASE,VETO_A121);
    IntDisable(INT_GPIOB);
}

void PL_GPIO_INT_Enable(void)
{
	GPIO_PORTL_ICR_R|=DEDX_A121;
	GPIOIntEnable(GPIO_PORTL_BASE,DEDX_A121);
	IntEnable(INT_GPIOL);

	//Clearing and disabling Bulk interrupts
	GPIO_PORTD_ICR_R|=BULK_A121;
	GPIOIntEnable(GPIO_PORTD_BASE,BULK_A121);
	IntEnable(INT_GPIOD);

	//Clearing and disabling Veto interrupts
    GPIO_PORTB_ICR_R|=VETO_A121;
    GPIOIntEnable(GPIO_PORTB_BASE,VETO_A121);
    IntEnable(INT_GPIOB);
}

//For corrective action
//In the I2C interrupt, this command must be run and the parameter mode_change must be changed to the correct value
//This ensures that there will not be any interrupts, etc., happening during the change
void PL_PREV_STATE_CHECK(uint8_t parameter)
{
	if((pyld_status==3)&&(parameter==2))
	{

		UARTprintf("Entering hibernate from Science data state\n");
		PL_SCIENCE_INT_DISABLE();
		//HV_Value_Set(low_voltage);
		Clean_Buffer();
	}
	if((pyld_status==3)&&(parameter==1))
	{
		UARTprintf("Entering standby from Science state\n");
		PL_SCIENCE_INT_DISABLE();
		//HV_Value_Set(0);
		Disable_Analog();
	}
	if((pyld_status==2)&&(parameter==1))
	{
		UARTprintf("Entering standby from hibernate state\n");
		//HV_Value_Set(0);
		Disable_Analog();
	}
}
void SEND_HK(void)
{

}





#endif /* FUNCTIONS_H_ */
